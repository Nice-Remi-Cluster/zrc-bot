# roll 插件使用文档

## 插件简介

roll 插件是一个功能丰富的随机数生成和随机选择工具，提供多种随机化算法和使用模式。该插件广泛应用于游戏娱乐、决策辅助、抽奖活动等多种场景，具有简单易用、功能全面的特点。

### 核心特性
- 多模式随机数生成
- 智能参数识别
- 自然语言交互
- 高质量随机算法
- 无限选项支持

## 主要功能

### 随机数生成与选择
```
/roll [options...]
```

该插件支持三种主要的随机模式，能够根据输入参数自动识别并执行相应的随机操作。

## 使用模式详解

### 1. 默认随机模式（无参数）
```
/roll
```

**功能说明：**
生成 0-100 之间的随机整数，适用于百分比计算、通用随机数需求等场景。

**技术实现：**
使用 `random.randint(0, 100)` 生成均匀分布的随机整数。

**使用示例：**
```
用户: /roll
机器人: 42

用户: /roll
机器人: 87
```

### 2. 指定范围模式
```
/roll <number>
```

**功能说明：**
生成 0 到指定数字之间的随机整数，支持自定义上限值。

**参数要求：**
- `number`: 必须为正整数，作为随机数的上限（包含）
- 下限固定为 0

**使用示例：**
```
用户: /roll 20
机器人: 15

用户: /roll 6
机器人: 4

用户: /roll 1000
机器人: 573
```

### 3. 随机选择模式
```
/roll <option1> <option2> [option3...]
```

**功能说明：**
从提供的多个选项中随机选择一个，支持任意数量的选项和任意类型的文本内容。

**参数特性：**
- 支持中文、英文、数字、符号等任意字符
- 选项数量无限制（建议不超过50个以保证可读性）
- 每个选项以空格分隔

**使用示例：**
```
用户: /roll 苹果 香蕉 橙子
机器人: 香蕉

用户: /roll 看电影 打游戏 学习 睡觉
机器人: 打游戏

用户: /roll A方案 B方案 C方案 D方案
机器人: C方案
```

## 使用场景

### 1. 游戏场景
```
/roll 6          # 模拟骰子
/roll 100        # 百分比随机
/roll 20         # D20骰子
```

### 2. 决策辅助
```
/roll 去 不去                    # 二选一
/roll 看电影 打游戏 睡觉 学习      # 多选一
/roll A方案 B方案 C方案           # 方案选择
```

### 3. 抽奖活动
```
/roll 张三 李四 王五 赵六         # 随机抽取获奖者
/roll 一等奖 二等奖 三等奖 谢谢参与  # 奖项抽取
```

### 4. 娱乐互动
```
/roll 真心话 大冒险              # 游戏选择
/roll 猫 狗 兔子 仓鼠            # 宠物选择
```

## 技术原理

### 算法架构

#### 参数解析逻辑
插件采用智能参数识别机制，根据输入参数的数量和类型自动选择相应的处理模式。

```python
# 核心处理逻辑
def process_roll_command(options):
    # 模式1：无参数 - 默认0-100随机数
    if not options:
        result = random.randint(0, 100)
        return result
    
    # 模式2：单个数字参数 - 指定范围随机数
    elif len(options) == 1 and options[0].isdigit():
        upper_limit = int(options[0])
        result = random.randint(0, upper_limit)
        return result
    
    # 模式3：多个参数 - 随机选择
    else:
        result = random.choice(options)
        return result
```

#### 随机数生成器
- **算法基础**: 使用Python内置的Mersenne Twister伪随机数生成器
- **分布特性**: 保证均匀分布，确保每个可能结果的概率相等
- **种子机制**: 基于系统时间自动初始化，确保每次运行的随机性

### 框架集成

#### 命令处理框架
- **解析器**: 基于Alconna框架的MultiVar参数处理
- **参数验证**: 自动验证参数格式和数量
- **错误处理**: 内置异常处理机制

#### 性能优化
- **内存效率**: 最小化内存占用，支持大量选项处理
- **计算复杂度**: O(1)时间复杂度，确保快速响应
- **并发安全**: 线程安全的随机数生成

## 高级用法与应用场景

### 游戏应用

#### 桌游辅助
```
/roll 6          # 标准六面骰子
/roll 20         # D20骰子（龙与地下城）
/roll 100        # 百分比骰子
/roll 4          # D4骰子
```

#### 游戏决策
```
/roll 攻击 防御 技能 道具     # 战斗选择
/roll 左路 中路 右路         # 路线选择
/roll 法师 战士 盗贼 牧师     # 职业选择
```

### 日常决策

#### 生活选择
```
/roll 中餐 西餐 日料 韩料     # 用餐选择
/roll 电影 游戏 读书 运动     # 娱乐活动
/roll 早睡 熬夜             # 作息决策
```

#### 学习工作
```
/roll 数学 英语 编程 设计     # 学习科目
/roll 继续努力 休息一下 换个思路 寻求帮助  # 学习策略
/roll 项目A 项目B 项目C      # 工作优先级
```

### 创意应用

#### 占卜娱乐
```
/roll 今天运势极佳 今天运势不错 今天运势一般 今天要小心  # 运势占卜
/roll 宜出行 宜学习 宜休息 宜社交                    # 今日宜忌
```

#### 团队活动
```
/roll 张三 李四 王五 赵六     # 随机选人
/roll 队长 副队长 队员       # 角色分配
/roll 真心话 大冒险         # 聚会游戏
```

### 数值应用

#### 概率模拟
```
/roll 100       # 百分比概率
/roll 10        # 十分制评分
/roll 5         # 五星评级
```

#### 随机抽样
```
/roll 1 2 3 4 5 6 7 8 9 10    # 从数字序列中选择
/roll A B C D E F G H I J      # 从字母序列中选择
```

## 注意事项

### 使用限制
1. **参数数量**: 理论上支持无限个选项，但建议控制在50个以内以保证可读性
2. **参数格式**: 选项之间必须用空格分隔，不支持包含空格的单个选项
3. **数字识别**: 只有纯数字字符串才会被识别为数字上限，混合字符将被视为选项
4. **字符支持**: 支持Unicode字符，包括中文、日文、韩文、表情符号等

### 技术特性
1. **随机性质**: 使用伪随机数生成器，对于一般应用场景具有足够的随机性
2. **性能考虑**: 大量选项可能影响响应速度，建议合理控制选项数量
3. **内存使用**: 选项内容会临时存储在内存中，超长文本可能影响性能
4. **并发处理**: 支持多用户同时使用，每次调用独立处理

### 最佳实践
1. **选项命名**: 使用简洁明了的选项名称，避免过长的描述
2. **数量控制**: 建议选项数量控制在2-20个之间，确保良好的用户体验
3. **语义清晰**: 确保选项之间语义独立，避免歧义
4. **合理使用**: 避免频繁调用，给其他用户留出使用空间

## 常见问题解答

### 功能相关

**Q: 如何生成指定范围的随机数（如5-15之间）？**
A: 目前只支持从0开始的范围。如需要其他范围，可以使用选择模式列出所有可能值：
```
/roll 5 6 7 8 9 10 11 12 13 14 15
```
或者生成0-10的随机数后手动加5。

**Q: 选项中包含空格怎么办？**
A: 当前版本不支持包含空格的单个选项，建议使用以下替代方案：
- 使用下划线：`今天_吃_什么`
- 使用连字符：`今天-吃-什么`
- 使用中文标点：`今天吃什么？`

**Q: 可以生成小数吗？**
A: 当前版本只支持整数生成。如需小数，建议生成整数后除以相应倍数，或使用选择模式列出小数选项。

### 技术相关

**Q: 随机结果是否真正随机？**
A: 使用Python的Mersenne Twister伪随机数生成器，具有以下特性：
- 周期长度为2^19937-1
- 通过多项统计随机性测试
- 对于非密码学用途具有足够的随机性
- 不适用于安全敏感的随机数需求

**Q: 多次调用会影响随机性吗？**
A: 不会。每次调用都是独立的随机事件，不会相互影响。

**Q: 支持的最大数字是多少？**
A: 理论上支持Python整数的最大值，但建议使用合理范围（如1-1000000）以确保良好性能。

### 使用技巧

**Q: 如何提高选择的公平性？**
A: 插件使用均匀分布算法，每个选项被选中的概率相等。确保选项数量和内容的合理性即可。

**Q: 可以保存常用的选项组合吗？**
A: 当前版本不支持保存功能，建议将常用组合记录在笔记中，需要时复制粘贴使用。